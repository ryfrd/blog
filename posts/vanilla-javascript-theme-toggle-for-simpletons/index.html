<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    
    <link rel="icon" href="/image/icon.webp" type="image/icon type" -->
    
    <link href="/dark.css" rel="stylesheet" id="stylesheet">
    <title>james mclaren</title>
  </head>
  <body>
  <script src="https://kit.fontawesome.com/460d3298b2.js" crossorigin="anonymous"></script>
  <script src="/toggle.js"></script>

  <div class="nav left-right">
    <div class="left">
      <a href="/" class="title nav-left-item squishy">james mclaren</a>
      <button id="themeButton" class="toggle-button nav-left-item squishy" onclick="toggleTheme()">
<i class="fa-solid fa-circle-half-stroke"></i>
      </button>
    </div>
    <div class="right">
      
        <a class="nav-right-item squishy" href="/posts/">all posts</a>
      
        <a class="nav-right-item squishy" href="/tags/">topics</a>
      
    </div>
  </div>
  
  <div class="body-container">


<div class="body-container">
  <h3>vanilla javascript theme toggle for simpletons</h3>
  <p>Sometimes when I&rsquo;m trawling the internet and happen upon a particularly nice looking website, I develop css and javascript FOMO. The thing I&rsquo;ve been lusting after above all else is one of those fancy little dark theme toggle buttons. As you can probably tell from the website you&rsquo;re looking at my web dev skills are limited. As a result of this I had assumed such niceties were out of reach.</p>
<p>Last week though I decided it was time for this to change! I would do a teeny bit of javascript. I could have nice things. This is a rundown of the very simple implementation I came up with.</p>
<h3 id="html">HTML</h3>
<p>First things first, we&rsquo;ll need a button for users to click. This can be plopped wherever you want on your site.</p>
<div class="highlight"><pre tabindex="0" style="color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#fb4934">button</span> <span style="color:#b8bb26;font-weight:bold">id</span><span style="color:#fe8019">=</span><span style="color:#b8bb26">&#34;themeButton&#34;</span> <span style="color:#b8bb26;font-weight:bold">onclick</span><span style="color:#fe8019">=</span><span style="color:#b8bb26">&#34;toggleTheme()&#34;</span> <span style="color:#b8bb26;font-weight:bold">class</span><span style="color:#fe8019">=</span><span style="color:#b8bb26">&#34;theme-button&#34;</span>&gt;
</span></span></code></pre></div><p>The <code>id</code> will let us reference the button from our javascript, <code>onclick</code> tells the button to call the <code>toggleTheme()</code> function we&rsquo;ll write in a minute, and the <code>theme-button</code> class will let us theme the button from our css.</p>
<h3 id="css">CSS</h3>
<p>In order to achieve our magic theme switching we&rsquo;re going to split our css out in to three files: <code>base.css</code>, <code>dark.css</code>, and <code>light.css</code>. The <code>dark.css</code> and <code>light.css</code> files will do the same thing: import all the common css and define a root pseudo-class to store our color variables. For example a very simple <code>dark.css</code> would look like this.</p>
<div class="highlight"><pre tabindex="0" style="color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-css" data-lang="css"><span style="display:flex;"><span><span style="color:#928374;font-style:italic">/* import common css */</span>
</span></span><span style="display:flex;"><span>@<span style="color:#fe8019">import</span> <span style="color:#fb4934">url</span><span style="color:#fe8019">(</span><span style="color:#b8bb26">&#34;base.css&#34;</span><span style="color:#fe8019">)</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic">/* define colors */</span>
</span></span><span style="display:flex;"><span>:root {
</span></span><span style="display:flex;"><span>  --bg: <span style="color:#fe8019">black</span>;
</span></span><span style="display:flex;"><span>  --fg: <span style="color:#fe8019">white</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>The <code>base.css</code> will simply store all the other styling you want. Here you can reference the color variables defined in the <code>dark.css</code> and <code>light.css</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-css" data-lang="css"><span style="display:flex;"><span><span style="color:#fb4934">body</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#fe8019">background-color</span>: <span style="color:#fabd2f">var</span>(<span style="color:#fe8019">--</span>bg);
</span></span><span style="display:flex;"><span>  <span style="color:#fe8019">color</span>: <span style="color:#fabd2f">var</span>(<span style="color:#fe8019">--</span>fg);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="js">JS</h3>
<p>Now with the groundwork in place we can stick it all together with the javascript. The gameplan here is to check the <code>href</code> attribute of the <code>stylesheet</code> element. Then if it&rsquo;s set to <code>dark.css</code> switch it to <code>light.css</code> and vice-versa. my <code>toggleTheme</code> function looked like this.</p>
<div class="highlight"><pre tabindex="0" style="color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#fe8019">function</span> toggleTheme() {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#fe8019">var</span> stylesheet <span style="color:#fe8019">=</span> <span style="color:#fabd2f">document</span>.getElementById(<span style="color:#b8bb26">&#39;stylesheet&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#fe8019">if</span> (stylesheet.getAttribute(<span style="color:#b8bb26">&#39;href&#39;</span>) <span style="color:#fe8019">===</span> <span style="color:#b8bb26">&#39;/dark.css&#39;</span>) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#928374;font-style:italic">// update stylesheet
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>    stylesheet.setAttribute(<span style="color:#b8bb26">&#39;href&#39;</span>, <span style="color:#b8bb26">&#39;/light.css&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  } <span style="color:#fe8019">else</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#928374;font-style:italic">// update stylesheet
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>    stylesheet.setAttribute(<span style="color:#b8bb26">&#39;href&#39;</span>, <span style="color:#b8bb26">&#39;/dark.css&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>This works well except for one little problem: when you refresh or load a new page, the stylesheet is returned to its default. This short term memory can be fixed though so theme changes persist through page loads.</p>
<p>First we need to update our <code>toggleTheme</code> function to store our theme changes locally.</p>
<div class="highlight"><pre tabindex="0" style="color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#fe8019">function</span> toggleTheme() {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#fe8019">var</span> stylesheet <span style="color:#fe8019">=</span> <span style="color:#fabd2f">document</span>.getElementById(<span style="color:#b8bb26">&#39;stylesheet&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#fe8019">if</span> (stylesheet.getAttribute(<span style="color:#b8bb26">&#39;href&#39;</span>) <span style="color:#fe8019">===</span> <span style="color:#b8bb26">&#39;/dark.css&#39;</span>) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#928374;font-style:italic">// update stylesheet
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>    stylesheet.setAttribute(<span style="color:#b8bb26">&#39;href&#39;</span>, <span style="color:#b8bb26">&#39;/light.css&#39;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#928374;font-style:italic">// store theme
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>    localStorage.setItem(<span style="color:#b8bb26">&#39;stylesheet&#39;</span>, <span style="color:#b8bb26">&#39;/light.css&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  } <span style="color:#fe8019">else</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#928374;font-style:italic">// update stylesheet
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>    stylesheet.setAttribute(<span style="color:#b8bb26">&#39;href&#39;</span>, <span style="color:#b8bb26">&#39;/dark.css&#39;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#928374;font-style:italic">// store theme
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>    localStorage.setItem(<span style="color:#b8bb26">&#39;stylesheet&#39;</span>, <span style="color:#b8bb26">&#39;/dark.css&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>We then add an event listener to check if there is a theme stored on page loads.</p>
<div class="highlight"><pre tabindex="0" style="color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#fabd2f">window</span>.addEventListener(<span style="color:#b8bb26">&#39;load&#39;</span>, <span style="color:#fe8019">function</span>() {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#928374;font-style:italic">// get stored style
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>  <span style="color:#fe8019">var</span> storedStyle <span style="color:#fe8019">=</span> localStorage.getItem(<span style="color:#b8bb26">&#39;stylesheet&#39;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#fe8019">var</span> stylesheet <span style="color:#fe8019">=</span> <span style="color:#fabd2f">document</span>.getElementById(<span style="color:#b8bb26">&#39;stylesheet&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#928374;font-style:italic">// set stored style if it exists
</span></span></span><span style="display:flex;"><span><span style="color:#928374;font-style:italic"></span>  <span style="color:#fe8019">if</span> (storedStyle) {
</span></span><span style="display:flex;"><span>    stylesheet.setAttribute(<span style="color:#b8bb26">&#39;href&#39;</span>, storedStyle);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>Finally, don&rsquo;t forget to add your javascript to your html somewhere.</p>
<div class="highlight"><pre tabindex="0" style="color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#fb4934">script</span> <span style="color:#b8bb26;font-weight:bold">src</span><span style="color:#fe8019">=</span><span style="color:#b8bb26">&#34;/toggle.js&#34;</span>&gt;&lt;/<span style="color:#fb4934">script</span>&gt;
</span></span></code></pre></div><p>Hope you&rsquo;ve enjoyed. Toggle toggle toggle!</p>

</div>

<footer>
  <small>
    <div class="foot-message">made with <a href="https://gohugo.io">hugo</a> and <a href="https://github.com/ryfrd/hugo-goose">hugo-goose</a></div>
  </small>
</footer>
</div> 
</body>
</html>

